<div class="learning-hub">
    <header class="hub-hero glass-panel">
        <div class="hero-row">
            <div>
                <p class="eyebrow">Active recall</p>
                <h1>Learning Hub</h1>
                <p class="hero-subtitle">Tap, decide, move on in under 3s.</p>
            </div>
            <div class="hero-actions">
                <button class="icon-btn ghost" data-action="view-my-skills" aria-label="My skills">
                    <i data-feather="target"></i>
                </button>
                <button class="btn btn-primary pill" data-action="add-new-skill">
                    <i data-feather="plus"></i>
                    <span>New Skill</span>
                </button>
            </div>
        </div>
        <div class="hero-metrics">
            <div class="metric-chip">
                <span class="chip-label">Due today</span>
                <strong>{{reviewsDue}}</strong>
                <small>cards</small>
            </div>
            <div class="metric-chip">
                <span class="chip-label">Active packs</span>
                <strong>{{activePacks.length}}</strong>
                <small>in rotation</small>
            </div>
            <div class="metric-chip">
                <span class="chip-label">Library</span>
                <strong>{{packs.length}}</strong>
                <small>available</small>
            </div>
        </div>
    </header>

    <section class="hub-section glass-panel quick-cta">
        <div class="action-row">
            {{#if primaryPackId}}
            <button class="btn btn-primary full-width" data-action="smart-pack" data-pack-id="{{primaryPackId}}" data-installed="{{primaryPackInstalled}}">
                <span>Siguiente tarjeta</span>
                <small class="microcopy">Continuar donde quedaste</small>
            </button>
            <button class="btn btn-secondary full-width" data-action="start-reviews">
                <span>Repasar ahora</span>
                <small class="microcopy">Errores y pendientes</small>
            </button>
            {{else}}
            <button class="btn btn-primary full-width" data-action="start-pack" data-pack-id="{{packs.0.id}}">
                <span>Empieza con un pack</span>
                <small class="microcopy">1 tap para practicar</small>
            </button>
            <button class="btn btn-secondary full-width" data-action="import-pack">
                <span>Importar pack</span>
                <small class="microcopy">Trae tu propio contenido</small>
            </button>
            {{/if}}
        </div>
    </section>

    <section class="hub-section glass-panel practice-stack">
        <div class="section-heading">
            <div>
                <p class="eyebrow">Learning card</p>
                <h2>Flashcard activa</h2>
                <p class="microcopy">Una accion por pantalla. Pulgar primero.</p>
            </div>
            <span class="pill muted">Flashcard</span>
        </div>

        {{#if activePacks.length}}
        <article class="learning-card" aria-live="polite">
            <div class="card-meta">
                <div class="pill-row">
                    <span class="pill">{{activePacks.0.type}}</span>
                    <span class="pill muted">{{activePacks.0.difficulty}}</span>
                </div>
                <div class="card-progress" style="--progress: {{activePacks.0.progress}};">
                    <div class="card-progress-fill"></div>
                    <span class="card-progress-label">{{activePacks.0.progress}}%</span>
                </div>
            </div>
            <details class="flashcard-shell">
                <summary>
                    <p class="card-pack-title">{{activePacks.0.title}}</p>
                    <p class="card-prompt">{{activePacks.0.subtitle}}</p>
                    <p class="reveal-hint">Tap para ver. Swipe -> lo se / <- repetir</p>
                </summary>
                <div class="card-answer">
                    <p>Flip, decide, sigue. Active recall sin leer de mas.</p>
                    <div class="flashcard-actions">
                        <button class="chip success" data-action="continue-pack" data-pack-id="{{activePacks.0.id}}">
                            <span>Lo se</span>
                        </button>
                        <button class="chip warning" data-action="start-reviews">
                            <span>Repetir</span>
                        </button>
                        <button class="chip ghost" data-action="start-quiz" data-pack-id="{{activePacks.0.id}}">
                            <span>Quiz rapido</span>
                        </button>
                    </div>
                </div>
            </details>
        </article>
        {{else}}
        <div class="empty-state">
            <h3>Sin pack activo</h3>
            <p>Instala un pack y arranca con tarjetas moviles.</p>
            <div class="empty-actions">
                <button class="btn btn-primary" data-action="start-pack" data-pack-id="{{packs.0.id}}">Empezar</button>
                <button class="btn btn-secondary" data-action="import-pack">Importar</button>
            </div>
        </div>
        {{/if}}
    </section>

    <section class="hub-section pack-picker glass-panel">
        <div class="section-heading">
            <div>
                <p class="eyebrow">Biblioteca</p>
                <h2>Elige tu reto</h2>
            </div>
            <div class="pill muted">Toca para entrar</div>
        </div>
        <div class="filters compact">
            <input type="text" id="pack-search" placeholder="Busca packs..." class="input-field">
            <div class="filter-pills">
                <select id="pack-filter-type" class="input-field pill-select">
                    <option value="">Tipos</option>
                    <option value="language">Language</option>
                    <option value="certification">Certification</option>
                </select>
                <select id="pack-filter-difficulty" class="input-field pill-select">
                    <option value="">Dificultad</option>
                    <option value="beginner">Beginner</option>
                    <option value="intermediate">Intermediate</option>
                    <option value="advanced">Advanced</option>
                </select>
            </div>
        </div>
        <div id="packs-grid" class="packs-grid mobile-scroll">
            {{#each packs}}
            <article class="pack-card glass-panel" data-action="open-pack-card" data-installed="{{this.installed}}" data-pack-id="{{this.id}}" data-type="{{this.type}}" data-difficulty="{{this.difficulty}}">
                <div class="pack-top">
                    <div class="pack-badges">
                        <span class="pill">{{this.type}}</span>
                        <span class="pill muted">{{this.difficulty}}</span>
                    </div>
                    <div class="pack-progress">
                        <div class="pack-dots" style="--count: {{this.size_cards}};"></div>
                        <span class="pack-duration">{{this.duration_days}}d</span>
                    </div>
                </div>
                <h3 class="pack-title">{{this.title}}</h3>
                <p class="pack-subtitle">{{this.subtitle}}</p>
                <div class="pack-tags">{{this.ui_hint_tags_markup}}</div>
                <div class="pack-cta-row">
                    <div class="pack-meta-stack">
                        <span>{{this.size_cards}} cards | {{this.duration_days}} days</span>
                    </div>
                    <div class="pack-cta">
                        {{#if this.installed}}
                        <button class="btn btn-primary" data-action="continue-pack" data-pack-id="{{this.id}}">Continuar</button>
                        {{else}}
                        <button class="btn btn-primary" data-action="start-pack" data-pack-id="{{this.id}}">Start</button>
                        {{/if}}
                    </div>
                </div>
            </article>
            {{/each}}
        </div>
    </section>

    {{#if reviewsDue}}
    <section class="hub-section glass-panel">
        <div class="section-heading">
            <div>
                <p class="eyebrow">Reviews due</p>
                <h2>Listo para repasar</h2>
            </div>
            <span class="pill positive">{{reviewsDue}} cards</span>
        </div>
        <p class="microcopy">Haz un repaso rapido para mantener la racha.</p>
        <button class="btn btn-primary full-width" data-action="start-reviews">Empezar ahora</button>
    </section>
    {{/if}}

    <section class="hub-section glass-panel">
        <div class="section-heading">
            <div>
                <p class="eyebrow">Crear / Importar</p>
                <h2>Trae tus retos</h2>
            </div>
            <span class="pill muted">1 tap</span>
        </div>
        <div class="creation-grid">
            <button class="btn btn-secondary" data-action="import-pack">Importar pack</button>
            <button class="btn btn-secondary" data-action="create-pack">Crear pack</button>
            <button class="btn btn-secondary" data-action="generate-pack">Generar con AI</button>
        </div>
    </section>

    <div class="bottom-action-bar glass-panel" aria-label="Primary actions">
        <button class="bar-btn ghost" data-action="start-reviews">
            <span class="bar-icon">>> </span>
            <span>Repetir</span>
        </button>
        <button class="bar-btn primary" data-action="smart-pack" data-pack-id="{{primaryPackId}}" data-installed="{{primaryPackInstalled}}" {{#if primaryPackId}}{{else}}disabled{{/if}}>
            <span class="bar-icon">> </span>
            <span>Siguiente</span>
        </button>
        <button class="bar-btn ghost" data-action="smart-pack" data-pack-id="{{primaryPackId}}" data-installed="{{primaryPackInstalled}}" {{#if primaryPackId}}{{else}}disabled{{/if}}>
            <span class="bar-icon">*</span>
            <span>Debil</span>
        </button>
        <div class="bar-progress" style="--progress: {{reviewsDue}};">
            <div class="bar-track">
                <div class="bar-fill"></div>
            </div>
            <span class="bar-label">Progreso diario</span>
        </div>
    </div>
</div>
